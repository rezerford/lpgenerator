<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta content="IE=edge" http-equiv="X-UA-Compatible">
	<meta content="width=device-width, initial-scale=1.0" name="viewport">
	<title>Landing Page</title>
	<link rel="stylesheet" href="../media/css/main.css">
	<link rel="stylesheet" href="../media/css/jquery-ui-1.10.4.custom.min.css">

	<script src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
	<script src="../media/js/jquery-ui-1.10.4.custom.min.js"></script>
 </head>
<body>
  <div id="page">
  
  </div>      
</body>
</html>
<script type="text/javascript">

	var counter = 0;
	var currentElement;
	var elementStack = new Array();
	
	function showTools(elementName){
		
		switch(elementName){
			case 'section':
			case 'div':
				
				parent.document.getElementById("tools_section").style.display = 'block';
				
				parent.jQuery('#colorSelectorBackground').ColorPicker({
					color: '#0000ff',
					onShow: function (colpkr) {
						parent.jQuery(colpkr).fadeIn(500);
						return false;
					},
					onHide: function (colpkr) {
						parent.jQuery(colpkr).fadeOut(500);
						return false;
					},
					onChange: function (hsb, hex, rgb) {
						parent.jQuery('#colorSelectorBackground div').css('backgroundColor', '#' + hex);
						currentElement.style.backgroundColor = '#' + hex;
						currentElement.elementBackgroundColor = hex;
					}
				});

				parent.jQuery('#colorSelectorBorder').ColorPicker({
					color: '#0000ff',
					onShow: function (colpkr) {
						parent.jQuery(colpkr).fadeIn(500);
						return false;
					},
					onHide: function (colpkr) {
						parent.jQuery(colpkr).fadeOut(500);
						return false;
					},
					onChange: function (hsb, hex, rgb) {
						parent.jQuery('#colorSelectorBorder div').css('backgroundColor', '#' + hex);
						currentElement.style.borderColor = '#' + hex;
						currentElement.elementBorderColor = hex;
					}
				});

				parent.jQuery('#colorSelectorShadow').ColorPicker({
					color: '#0000ff',
					onShow: function (colpkr) {
						parent.jQuery(colpkr).fadeIn(500);
						return false;
					},
					onHide: function (colpkr) {
						parent.jQuery(colpkr).fadeOut(500);
						return false;
					},
					onChange: function (hsb, hex, rgb) {
						parent.jQuery('#colorSelectorShadow div').css('backgroundColor', '#' + hex);
						parent.jQuery("#shadow-color").val("#" + hex);
						parent.LP.changeShadow();

						currentElement.elementShadowColor = hex;
					}
				});

				parent.jQuery('#colorSelectorStart').ColorPicker({
					color: '#0000ff',
					onShow: function (colpkr) {
						parent.jQuery(colpkr).fadeIn(500);
						return false;
					},
					onHide: function (colpkr) {
						parent.jQuery(colpkr).fadeOut(500);
						return false;
					},
					onChange: function (hsb, hex, rgb) {
						parent.jQuery('#colorSelectorStart div').css('backgroundColor', '#' + hex);
						//parent.jQuery("#shadow-color").val("#" + hex);
						parent.LP.changeLinearGradient();

						currentElement.elementStartColor = hex;
					}
				});
				
				parent.jQuery('#colorSelectorEnd').ColorPicker({
					color: '#0000ff',
					onShow: function (colpkr) {
						parent.jQuery(colpkr).fadeIn(500);
						return false;
					},
					onHide: function (colpkr) {
						parent.jQuery(colpkr).fadeOut(500);
						return false;
					},
					onChange: function (hsb, hex, rgb) {
						parent.jQuery('#colorSelectorEnd div').css('backgroundColor', '#' + hex);
						//parent.jQuery("#shadow-color").val("#" + hex);
						parent.LP.changeLinearGradient();

						currentElement.elementEndColor = hex;
					}
				});

				parent.jQuery('#colorSelectorFont').ColorPicker({
					color: '#0000ff',
					onShow: function (colpkr) {
						parent.jQuery(colpkr).fadeIn(500);
						return false;
					},
					onHide: function (colpkr) {
						parent.jQuery(colpkr).fadeOut(500);
						return false;
					},
					onChange: function (hsb, hex, rgb) {
						parent.jQuery('#colorSelectorFont div').css('backgroundColor', '#' + hex);
						currentElement.elementFontColor = hex;
						currentElement.style.color = '#' + hex;
					}
				});
				
			break;
		}
		
	}
	
	function bindDraggable(element, elementName)
	{
		jQuery(element).draggable();
	}

	function setContentEditable(element)
	{
		element.setAttribute('contenteditable', 'true');
		jQuery(element).focus();
	}

	function bindResizable(element, elementName){
		
		counter++;
		element.uniqueid = counter;

		jQuery(element).bind("click", function(e){
			selectElement(element, elementName);
			return false;
		});

		jQuery(element).bind("dblclick", function(e){
			setContentEditable(element);
			return false;
		});
		
		addToStack(element);
		jQuery(element).resizable({
			resize: function( event, ui ) {
				var elementWidth = jQuery(ui.element).width();
				var elementHeight = jQuery(ui.element).height();

				parent.jQuery("#width").val(elementWidth);
				parent.jQuery("#height").val(elementHeight);

				currentElement.elementWidth = elementWidth;
				currentElement.elementHeight = elementHeight;
			}
		});
		
		
	}
	
	function addToStack(element){
		elementStack.push(element);
	}
	
	function selectElement(element, elementName){

		if(elementStack.length){
			for(var i=0; i < elementStack.length; i++){
				jQuery(elementStack[i]).removeClass("element-active");
				elementStack[i].setAttribute('contenteditable', 'false');
			}
		}

		jQuery(element).addClass("element-active");
		currentElement = element;
		
		changeToolParams(currentElement);
		showTools(elementName);
	}
	
	function changeToolParams(element)
	{
		var elementFontSize = (element.elementFontSize) ? element.elementFontSize : 25;
		var elementBackgroundColor = (element.elementBackgroundColor) ? element.elementBackgroundColor : "FFFFFF";
		var elementBorderColor = (element.elementBorderColor) ? element.elementBorderColor : "FFFFFF";
		var elementShadowColor = (element.elementShadowColor) ? element.elementShadowColor : "FFFFFF";

		var shadowXoffset = (element.shadowXoffset) ? element.shadowXoffset : 0;
		var shadowYoffset = (element.shadowYoffset) ? element.shadowYoffset : 0;
		var shadowBlur = (element.shadowBlur) ? element.shadowBlur : 0;
		var shadowInset = (element.shadowInset) ? element.shadowInset : "";

		var elementBorderStyle = (element.elementBorderStyle) ? element.elementBorderStyle : "solid";
		var elementBorderWidth = (element.elementBorderWidth) ? element.elementBorderWidth : 0;
		var elementBorderRadius = (element.elementBorderRadius) ? element.elementBorderRadius : 0;

		var elementWidth = (element.elementWidth) ? element.elementWidth : "100%";
		var elementHeight = (element.elementHeight) ? element.elementHeight : 350;
		var zIndex = (element.elementZIndex) ? element.elementZIndex : 1;
		var elementOpacity = (element.elementOpacity) ? element.elementOpacity : 1;

		parent.jQuery("#text-font-size").val(elementFontSize)
		parent.jQuery("#colorSelectorBackground div").css('backgroundColor', '#' + elementBackgroundColor);
		parent.jQuery("#colorSelectorBorder div").css('backgroundColor', '#' + elementBorderColor);
		parent.jQuery("#colorSelectorShadow div").css('backgroundColor', '#' + elementShadowColor);
		parent.jQuery("#shadow-color").val("#" + elementShadowColor);

		parent.jQuery("#border-style-button span.input").text(elementBorderStyle);
		parent.jQuery("#border-width").val(elementBorderWidth);
		parent.jQuery("#border-width").slider("refresh");
		parent.jQuery("#border-radius").val(elementBorderRadius);
		parent.jQuery("#border-radius").slider("refresh");

		parent.jQuery("#shadow-inset").slider("refresh");
		parent.jQuery("#shadow-x-offset").val(shadowXoffset);
		parent.jQuery("#shadow-x-offset").slider("refresh");
		parent.jQuery("#shadow-y-offset").val(shadowYoffset);
		parent.jQuery("#shadow-y-offset").slider("refresh");
		parent.jQuery("#shadow-blur-radius").val(shadowBlur);
		parent.jQuery("#shadow-blur-radius").slider("refresh");

		parent.jQuery("#width").val(elementWidth);
		parent.jQuery("#height").val(elementHeight);
		parent.jQuery("#z-index").val(zIndex);
		parent.jQuery("#z-index").slider("refresh");
		parent.jQuery("#opacity").val(elementOpacity);
		parent.jQuery("#opacity").slider("refresh");

		return true;
	}
	
</script>